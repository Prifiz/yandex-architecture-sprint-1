# Решение задания 1

## А стоит ли игра свеч?
В уроке о микрофронтендах заострено внимание на том, что разбиение не всегда оправдано. Поэтому первым моим шагом было убедиться, стоит ли в принципе это делать для текущего проекта. Ниже приведены чеклисты из уроков "за" и "против". Отмечены те из пунктов, которые на мой взгляд подходят к данному проекту.

Когда микрофронтенды — не лучшее решение:

	Приложение маленькое или простое								[x]
	Ресурсы разработки ограничены
    (только участник курса в личное время,
    лично у меня околонулевой опыт с фронтом и js)					[x]
	Компоненты тесно связаны
    (анализ кода показывает, что это в целом так)					[x]
	У вас краткосрочный проект или прототип
    (тренировочный проект)                   						[x]
	У вас жёсткие требования к производительности					[ ]
	В компании есть организационное или культурное сопротивление	[ ]
	Инфраструктура и инструментарий ограничены						[x]
	
	
Плюсы за микрофронтенды:

	Приложение сложное и продолжает расти							[ ]
	Нужно ускорить разработку и повысить её автономность			[ ]
	Есть проблемы с развёртыванием и масштабируемостью				[ ]
	Вам нужно технологическое разнообразие							[ ]
	Усложнилось сопровождение и обновление кода						[ ]

Как можно судить, наиболее рационально оставить всё как есть.
Но мы все понимаем, что основная задача - это попрактиковаться, поэтому ниже приведено решение задачи декомпозиции на микрофронтенды.

## Фреймворки для микрофронтендов
Явных требований нет, поэтому каждый микрофронтенд будет реализован на том же фреймворке (ReactJS), что и монолитный фронт. К тому же не заметил существенных причин, по которым требовались бы иные фреймворки (хотя вполне могу ошибаться, т.к. опыта в этой области нет)

## Фреймворк для создания микрофронтендов (Уровень 1)

Было принято решение использовать Module Federation по следующим причинам:

1. Общая зависимость CurrentUserContext.js
2. Не стоит задача бесшовной интеграции фреймворков
3. Проект относительно простой, поэтому Single SPA выглядит как некоторый overkill

## Планирование изменений (Уровень 2)

Выделены следующие микрофронтенды:

### auth-microfrontend

Микрофронтенд с единственной бизнес-задачей - безопасность. Функции включают вход и регистрацию, а также связанный только с этими функциями tooltip. Здесь же размещен auth.js, отвечающий за выполнение запросов в сторонний сервис для задач описанных бизнес-функций.

### card-microfrontend

Микрофронтенд, отвечающий за бизнес-процессы, связанные с карточкой места. В изначальном состоянии проекта эти функции были уже собраны в Card.js, поэтому выделение в отдельный микрофронтенд позволит разрабатывать эту логику независимо, а что важнее - масштабировать для случаев, когда карточек станет много.
Скорее всего впоследствии компонент Card.js должен быть декомпозирован на отдельные компоненты по зонам ответственности внутри этого же микрофронтенда (покрытие принципа single responsibility)

### profile-microfrontend

Микрофронтенд, предназначенный для действий с профилем пользователя. Помимо операций собственно над профилем пользователя, сюда же вынесены функции добавления места, поскольку это общее действие, не касающееся какой-то определенной карточки (поэтому выносить в card нельзя), а с другой стороны это не "скелет", т.к. фактически добавляет место от имени пользователя, и в этом смысле можно считать это действием над профилем. При этом при повышении нагрузки на сервис можно раздельно масштабировать card и profile и тем самым независимо управлять процессами добавления и отображения карточек.

### shell-microfrontend

Точка входа и основное приложение, использующее функционал других микрофронтендов. В терминах MF это host

Здесь решено оставить основную страницу с Header и Footer, а также действия по предпросмотру картинок.
Остался незакрытый вопрос о стилях для профиля, которые подтягиваются для компонента Main. Возможно эти стили стоит разместить в shared-lib и подтянуть оттуда, механика мне незнакома.

Остальные модули вполне независимы и отвечают одной бизнес-функции - отрисовка основной страницы приложения, фактически это скелет всего UI. Более того, в этой реализации, если вдруг остальные микрофронтенды будут недоступны, этот скелет будет отображаться, что положительно скажется на UX.

### shared-lib

Библиотека с функциями, использующимися в разных микрофронтендах. В данном случае это пока только CurrentUserContext.js

## Уровень 3 ***не реализован***

Настроить маршрутизацию и главное отладить приложение банально не успеваю, т.к. уже пора стартовать второй спринт.


# Решение задания 2

## Ссылка на схему

https://app.diagrams.net/#HPrifiz%2Fyandex-architecture-sprint-1%2Fsprint_1%2Ffrontend%2Fsprint_1_task_2.drawio.xml.drawio#%7B%22pageId%22%3A%22dqHeiV823vk1xwLtiMbG%22%7D

Схема расположена в этом же репозитории, в папке frontend

## Описание декомпозиции на микросервисы

### Support

Компонент отвечает за операции над заявками в техподдержку. Т.к. нет уточнений, то здесь принято, что заявки на апелляцию - тоже часть процесса техподдержки, поэтому функции апелляции внесены в этот же компонент.
Таким образом данный компонент должен функционировать как некий CRM-компонент, что позволит развертывать, развивать и масштабировать его изолированно от остальных компонентов системы.
На схеме для данного компонента изображена БД, но без объектов данных, поскольку на изначальной схеме отсутствовали объекты данных для процесса техподдержки. Тем не менее очевидна необходимость хранения данных заявок и апелляций.

### Auction

Компонент, отвечающий за реализацию бизнес-функционала аукциона.
Клиенты размещают аукционы, делают ставки, редактируют параметры а администратор валидирует заявки на аукционы. В задании этого не описано, но предполагаю, что статусы аукциона могут меняться при действиях как администратора, так и клиента.
На схеме для данного компонента изображена БД, но без объектов данных, поскольку на изначальной схеме отсутствовали объекты данных для процесса техподдержки. Тем не менее очевидна необходимость хранения данных аукциона.

### Report

В целом отчеты по различным бизнес-процессам могут быть разнесены по соответствующим компонентам, отвечающим за эти процессы. Однако я бы настоятельно рекомендовал вынести в отдельный сервис из соображений отказоустойчивости (отчеты могут быть довольно объемными, за большой период времени и требовать сложных доп. вычислений), а также избежания дублирования кода (например, если группа различных отчетов реализована схожим образом, похожими инструментами и т.п.). Не стал вносить на схему компоненты для построения отчетов, хранения шаблонов, т.к. в задании этого не требуется и мало времени. Также для сервиса отчетов может понадобиться дублирующее хранилище, возможно DWH для снижения нагрузки на сервисы-источники данных. Наполнение таких хранилищ может быть организовано в асинхронном режиме. Особенно это касается отчета по активности пользователей. Т.к. нет деталей по требованиям к статистике заказов, здесь считаю это также отчетом.

### Notification

Здесь логика выделения компонента во многом схожа с отчетами. Сервис нотификации должен содержать правила рассылок, виды нотификаций, подписки пользователей на нотификации. Также на схеме не стал изображать отдельные адаптеры нотификаций в зависимости от их вида (т.к. в текущем задании нет требований к типам), но в реальной системе скорее всего такой слой потребуется.

### Payment

Данный сервис инкапсулирует все операции, связанные с платежами. Выделение этого домена явно продиктовано отказоустойчивостью и масштибированием. Оплата - чувствительный фунционал, связанный с финансовыми операциями, который может испытывать пики нагрузок. Аналогично ситуации с нотификациями, здесь также могут потребоваться адаптеры к различным платежным системам. При декомпозиции был спорный момент с авторизацией платежной операции: иногда эту функцию считают частью общего блока security-операций, но в рамках данного задания включил в сервис payment ввиду отсутствия подробных требований и деталей.

### Offering

Каталог товаров и услуг. Фактически это CRUD-сервис. На текущем уровне детализации требований не вижу смысла отделять товары и услуги в разные компоненты, но возможно с развитием системы это и потребуется.
Про торговые площадки довольно мало данных. Поэтому на текущем этапе наиболее простым кажется внести объекты данных, связанные с торговыми площадками, в компонент Offering. Возможно на дальнейших этапах развития системы и при уточнении требований торговые площадки могут стать частью отдельного нового компонента


### Order

Компонент, отвечающий за весь набор бизнес-процессов, связанных с заказом.
Судя по текущим функциям, изображенным в монолите, это классический CRUD-компонент. И всё те же аспекты отказоустойчивости, масштабирования (например, в "черную пятницу" и прочие пики активности по заказам)

### User

Компонент отвечает за бизнес-функции, характерные для конкретных пользователей. Функция регистрации может в ряде случаев также присутствовать и в компоненте Security, но в условиях данного задания она больше относится к профилю как операция Create над ресурсом "пользователь".

Выделение этого компонента позволяет работать с профилем независимо от нагрузки на другие модули системы. Кроме того, компонент может обслуживать например микрофронтенд, также отвечающий за профиль, в случае его выделения. Как и в других случаях, разработкой компонента может заниматься независимо отдельная команда.

### Security

Компонент выделен по признаку процессов, отвечающих за безопасность приложения.
Его роль могут выполнять и сторонние сервисы, такие как например Keycloak
При разработке собственного решения выделение в самостоятельный компонент позволит учесть специфические требования к безопасности и отказоустойчивости.

## Фреймворк

Касаемо выбора фреймворков задача не стояла, поэтому по умолчанию сохранен текущий стек Django/Python для каждого компонента

## Портал электронной площадки

По порталу для наглядности также сделано разбиение на микрофронтенды. Новые компоненты придумывать не стал за недостатком времени, декомпозировал текущее. 

### Order-microfrontend
обслуживает процесс создания заказа, соответственно взаимодействие с компонентом Order

### Auction-microfrontend
отвечает за операции с аукционом, заявками на аукцион и ставками

### User-microfrontend
операции с профилем пользователя

### Offering-microfrontend
товары и услуги